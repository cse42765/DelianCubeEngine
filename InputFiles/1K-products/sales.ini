CREATE DIMENSION products_dim
RELATED SQL_TABLE products
LIST OF LEVEL {
    products.product_id AS lvl0,
    products.subcategory AS lvl1,
    products.category AS lvl2,
    products.ALL AS lvl3
}
HIERARCHY lvl0>lvl1>lvl2>lvl3;

CREATE DIMENSION locations_dim
RELATED SQL_TABLE locations
LIST OF LEVEL {
            locations.location_id AS lvl0,
            locations.city AS lvl1,
            locations.state AS lvl2,
            locations.ALL AS lvl3
}
HIERARCHY lvl0>lvl1>lvl2>lvl3;

CREATE DIMENSION dates_dim
RELATED SQL_TABLE dates
LIST OF LEVEL {
    dates.date_id AS lvl0,
    dates.date AS lvl1,
    dates.day AS lvl2,
    dates.month AS lvl3,
    dates.year AS lvl4,
    dates.ALL AS lvl5
}
HIERARCHY lvl0>lvl1>lvl2>lvl3>lvl4>lvl5;

CREATE CUBE sales_cube
RELATED SQL_TABLE sales
MEASURES sales AT sales.sales
REFERENCES DIMENSION locations_dim AT sales.location_id,
                     products_dim AT sales.product_id,
                     dates_dim AT sales.date_id
